2024-04-12 00:30:36,620 P569652 INFO Params: {
    "DFM": "none",
    "SSM": "GM",
    "alpha": "0.25",
    "batch_norm": "True",
    "batch_size": "10000",
    "c": "0.9",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "ML-1M_08e326cd",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "easy_hidden_units": "[400]",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'int', 'name': 'group_id', 'preprocess': 'copy_from(UserID)', 'remap': False, 'type': 'meta'}, {'active': True, 'dtype': 'float', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID'], 'type': 'categorical'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gamma": "2",
    "gpu": "2",
    "group_id": "group_id",
    "hard_hidden_units": "[400, 400, 400]",
    "hidden_activations": "relu",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC', 'gAUC']",
    "min_categr_count": "2",
    "model": "TF4CTRv2",
    "model_id": "TF4CTRv2_ML-1M_080_6c918493",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'gAUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_workers": "8",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2023",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/ML-1M/test.csv",
    "train_data": "../../../data/ML-1M/train.csv",
    "use_features": "None",
    "valid_data": "../../../data/ML-1M/valid.csv",
    "verbose": "1"
}
2024-04-12 00:30:36,624 P569652 INFO Set up feature processor...
2024-04-12 00:30:36,624 P569652 WARNING Skip rebuilding ../../../data/ML-1M_08e326cd/feature_map.json. Please delete it manually if rebuilding is required.
2024-04-12 00:30:36,624 P569652 INFO Load feature_map from json: ../../../data/ML-1M_08e326cd/feature_map.json
2024-04-12 00:30:36,624 P569652 INFO Set column index...
2024-04-12 00:30:36,625 P569652 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3547, 'vocab_size': 3548}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22, 'vocab_size': 23}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6041, 'vocab_size': 6042}",
    "group_id": "{'type': 'meta'}"
}
2024-04-12 00:30:42,127 P569652 INFO Total number of parameters: 556578.
2024-04-12 00:30:42,128 P569652 INFO Loading data...
2024-04-12 00:30:42,128 P569652 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/train.h5
2024-04-12 00:30:42,185 P569652 INFO Train samples: total/800167, blocks/1
2024-04-12 00:30:42,185 P569652 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/valid.h5
2024-04-12 00:30:42,191 P569652 INFO Validation samples: total/100021, blocks/1
2024-04-12 00:30:42,191 P569652 INFO Loading train and validation data done.
2024-04-12 00:30:42,191 P569652 INFO Start training: 81 batches/epoch
2024-04-12 00:30:42,191 P569652 INFO ************ Epoch=1 start ************
2024-04-12 00:30:44,837 P569652 INFO Train loss: 1.068544
2024-04-12 00:30:44,838 P569652 INFO Evaluation @epoch 1 - batch 81: 
2024-04-12 00:30:53,788 P569652 INFO ===
2024-04-12 00:30:53,788 P569652 INFO [Metrics] AUC: 0.779741 - gAUC: 0.732752 - logloss: 0.590251
2024-04-12 00:30:53,788 P569652 INFO Save best model: monitor(max)=1.512493
2024-04-12 00:30:53,957 P569652 INFO ************ Epoch=1 end ************
2024-04-12 00:30:56,698 P569652 INFO Train loss: 0.993172
2024-04-12 00:30:56,699 P569652 INFO Evaluation @epoch 2 - batch 81: 
2024-04-12 00:31:05,234 P569652 INFO ===
2024-04-12 00:31:05,234 P569652 INFO [Metrics] AUC: 0.791834 - gAUC: 0.738092 - logloss: 0.561682
2024-04-12 00:31:05,235 P569652 INFO Save best model: monitor(max)=1.529926
2024-04-12 00:31:05,429 P569652 INFO ************ Epoch=2 end ************
2024-04-12 00:31:07,998 P569652 INFO Train loss: 0.971541
2024-04-12 00:31:07,998 P569652 INFO Evaluation @epoch 3 - batch 81: 
2024-04-12 00:31:16,836 P569652 INFO ===
2024-04-12 00:31:16,836 P569652 INFO [Metrics] AUC: 0.800218 - gAUC: 0.749359 - logloss: 0.549264
2024-04-12 00:31:16,836 P569652 INFO Save best model: monitor(max)=1.549577
2024-04-12 00:31:16,980 P569652 INFO ************ Epoch=3 end ************
2024-04-12 00:31:19,792 P569652 INFO Train loss: 0.956594
2024-04-12 00:31:19,792 P569652 INFO Evaluation @epoch 4 - batch 81: 
2024-04-12 00:31:27,895 P569652 INFO ===
2024-04-12 00:31:27,896 P569652 INFO [Metrics] AUC: 0.805165 - gAUC: 0.756863 - logloss: 0.550330
2024-04-12 00:31:27,896 P569652 INFO Save best model: monitor(max)=1.562028
2024-04-12 00:31:28,034 P569652 INFO ************ Epoch=4 end ************
2024-04-12 00:31:30,692 P569652 INFO Train loss: 0.947313
2024-04-12 00:31:30,692 P569652 INFO Evaluation @epoch 5 - batch 81: 
2024-04-12 00:31:39,358 P569652 INFO ===
2024-04-12 00:31:39,359 P569652 INFO [Metrics] AUC: 0.807662 - gAUC: 0.759454 - logloss: 0.533902
2024-04-12 00:31:39,359 P569652 INFO Save best model: monitor(max)=1.567116
2024-04-12 00:31:39,485 P569652 INFO ************ Epoch=5 end ************
2024-04-12 00:31:41,960 P569652 INFO Train loss: 0.940196
2024-04-12 00:31:41,961 P569652 INFO Evaluation @epoch 6 - batch 81: 
2024-04-12 00:31:48,814 P569652 INFO ===
2024-04-12 00:31:48,815 P569652 INFO [Metrics] AUC: 0.809008 - gAUC: 0.761699 - logloss: 0.535549
2024-04-12 00:31:48,815 P569652 INFO Save best model: monitor(max)=1.570707
2024-04-12 00:31:48,950 P569652 INFO ************ Epoch=6 end ************
2024-04-12 00:31:51,601 P569652 INFO Train loss: 0.933629
2024-04-12 00:31:51,602 P569652 INFO Evaluation @epoch 7 - batch 81: 
2024-04-12 00:31:59,737 P569652 INFO ===
2024-04-12 00:31:59,737 P569652 INFO [Metrics] AUC: 0.811009 - gAUC: 0.765078 - logloss: 0.541752
2024-04-12 00:31:59,737 P569652 INFO Save best model: monitor(max)=1.576086
2024-04-12 00:31:59,937 P569652 INFO ************ Epoch=7 end ************
2024-04-12 00:32:02,429 P569652 INFO Train loss: 0.929982
2024-04-12 00:32:02,429 P569652 INFO Evaluation @epoch 8 - batch 81: 
2024-04-12 00:32:11,068 P569652 INFO ===
2024-04-12 00:32:11,068 P569652 INFO [Metrics] AUC: 0.809653 - gAUC: 0.762543 - logloss: 0.537991
2024-04-12 00:32:11,068 P569652 INFO Monitor(max)=1.572196 STOP!
2024-04-12 00:32:11,068 P569652 INFO Reduce learning rate on plateau: 0.000100
2024-04-12 00:32:11,204 P569652 INFO ************ Epoch=8 end ************
2024-04-12 00:32:13,747 P569652 INFO Train loss: 0.863567
2024-04-12 00:32:13,747 P569652 INFO Evaluation @epoch 9 - batch 81: 
2024-04-12 00:32:21,810 P569652 INFO ===
2024-04-12 00:32:21,810 P569652 INFO [Metrics] AUC: 0.814079 - gAUC: 0.766563 - logloss: 0.544038
2024-04-12 00:32:21,810 P569652 INFO Save best model: monitor(max)=1.580642
2024-04-12 00:32:21,954 P569652 INFO ************ Epoch=9 end ************
2024-04-12 00:32:24,437 P569652 INFO Train loss: 0.842371
2024-04-12 00:32:24,437 P569652 INFO Evaluation @epoch 10 - batch 81: 
2024-04-12 00:32:33,202 P569652 INFO ===
2024-04-12 00:32:33,202 P569652 INFO [Metrics] AUC: 0.813868 - gAUC: 0.765823 - logloss: 0.549249
2024-04-12 00:32:33,202 P569652 INFO Monitor(max)=1.579692 STOP!
2024-04-12 00:32:33,202 P569652 INFO Reduce learning rate on plateau: 0.000010
2024-04-12 00:32:33,338 P569652 INFO ************ Epoch=10 end ************
2024-04-12 00:32:35,801 P569652 INFO Train loss: 0.821823
2024-04-12 00:32:35,802 P569652 INFO Evaluation @epoch 11 - batch 81: 
2024-04-12 00:32:43,975 P569652 INFO ===
2024-04-12 00:32:43,975 P569652 INFO [Metrics] AUC: 0.813892 - gAUC: 0.765898 - logloss: 0.550118
2024-04-12 00:32:43,975 P569652 INFO Monitor(max)=1.579790 STOP!
2024-04-12 00:32:43,975 P569652 INFO Reduce learning rate on plateau: 0.000001
2024-04-12 00:32:43,975 P569652 INFO ********* Epoch==11 early stop *********
2024-04-12 00:32:44,106 P569652 INFO Training finished.
2024-04-12 00:32:44,106 P569652 INFO Load best model: /mnt/public/lhh/code/model_zoo/TF4CTR/TF4CTR_torch/checkpoints/ML-1M_08e326cd/TF4CTRv2_ML-1M_080_6c918493.model
2024-04-12 00:32:44,112 P569652 INFO ****** Validation evaluation ******
2024-04-12 00:32:51,512 P569652 INFO ===
2024-04-12 00:32:51,513 P569652 INFO [Metrics] logloss: 0.544038 - AUC: 0.814079 - gAUC: 0.766563
2024-04-12 00:32:51,554 P569652 INFO ******** Test evaluation ********
2024-04-12 00:32:51,555 P569652 INFO Loading data...
2024-04-12 00:32:51,555 P569652 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/test.h5
2024-04-12 00:32:51,563 P569652 INFO Test samples: total/100021, blocks/1
2024-04-12 00:32:51,573 P569652 INFO Loading test data done.
2024-04-12 00:32:58,993 P569652 INFO ===
2024-04-12 00:32:58,993 P569652 INFO [Metrics] logloss: 0.542416 - AUC: 0.814133 - gAUC: 0.767574
