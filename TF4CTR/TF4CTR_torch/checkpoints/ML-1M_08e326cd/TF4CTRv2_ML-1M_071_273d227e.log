2024-04-12 00:24:02,831 P258112 INFO Params: {
    "DFM": "WSF",
    "SSM": "none",
    "alpha": "0.25",
    "batch_norm": "True",
    "batch_size": "10000",
    "c": "0.8",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "ML-1M_08e326cd",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "easy_hidden_units": "[400]",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'int', 'name': 'group_id', 'preprocess': 'copy_from(UserID)', 'remap': False, 'type': 'meta'}, {'active': True, 'dtype': 'float', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID'], 'type': 'categorical'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gamma": "2",
    "gpu": "2",
    "group_id": "group_id",
    "hard_hidden_units": "[400, 400, 400]",
    "hidden_activations": "relu",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC', 'gAUC']",
    "min_categr_count": "2",
    "model": "TF4CTRv2",
    "model_id": "TF4CTRv2_ML-1M_071_273d227e",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'gAUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_workers": "8",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2023",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/ML-1M/test.csv",
    "train_data": "../../../data/ML-1M/train.csv",
    "use_features": "None",
    "valid_data": "../../../data/ML-1M/valid.csv",
    "verbose": "1"
}
2024-04-12 00:24:02,832 P258112 INFO Set up feature processor...
2024-04-12 00:24:02,832 P258112 WARNING Skip rebuilding ../../../data/ML-1M_08e326cd/feature_map.json. Please delete it manually if rebuilding is required.
2024-04-12 00:24:02,832 P258112 INFO Load feature_map from json: ../../../data/ML-1M_08e326cd/feature_map.json
2024-04-12 00:24:02,832 P258112 INFO Set column index...
2024-04-12 00:24:02,832 P258112 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3547, 'vocab_size': 3548}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22, 'vocab_size': 23}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6041, 'vocab_size': 6042}",
    "group_id": "{'type': 'meta'}"
}
2024-04-12 00:24:07,501 P258112 INFO Total number of parameters: 543620.
2024-04-12 00:24:07,502 P258112 INFO Loading data...
2024-04-12 00:24:07,502 P258112 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/train.h5
2024-04-12 00:24:07,562 P258112 INFO Train samples: total/800167, blocks/1
2024-04-12 00:24:07,562 P258112 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/valid.h5
2024-04-12 00:24:07,570 P258112 INFO Validation samples: total/100021, blocks/1
2024-04-12 00:24:07,570 P258112 INFO Loading train and validation data done.
2024-04-12 00:24:07,570 P258112 INFO Start training: 81 batches/epoch
2024-04-12 00:24:07,571 P258112 INFO ************ Epoch=1 start ************
2024-04-12 00:24:09,990 P258112 INFO Train loss: 1.041310
2024-04-12 00:24:09,990 P258112 INFO Evaluation @epoch 1 - batch 81: 
2024-04-12 00:24:16,706 P258112 INFO ===
2024-04-12 00:24:16,707 P258112 INFO [Metrics] AUC: 0.784430 - gAUC: 0.733131 - logloss: 0.596397
2024-04-12 00:24:16,707 P258112 INFO Save best model: monitor(max)=1.517560
2024-04-12 00:24:16,846 P258112 INFO ************ Epoch=1 end ************
2024-04-12 00:24:18,995 P258112 INFO Train loss: 0.964133
2024-04-12 00:24:18,995 P258112 INFO Evaluation @epoch 2 - batch 81: 
2024-04-12 00:24:26,093 P258112 INFO ===
2024-04-12 00:24:26,094 P258112 INFO [Metrics] AUC: 0.793817 - gAUC: 0.740363 - logloss: 0.539202
2024-04-12 00:24:26,094 P258112 INFO Save best model: monitor(max)=1.534180
2024-04-12 00:24:26,202 P258112 INFO ************ Epoch=2 end ************
2024-04-12 00:24:28,593 P258112 INFO Train loss: 0.945451
2024-04-12 00:24:28,593 P258112 INFO Evaluation @epoch 3 - batch 81: 
2024-04-12 00:24:34,844 P258112 INFO ===
2024-04-12 00:24:34,844 P258112 INFO [Metrics] AUC: 0.798407 - gAUC: 0.746574 - logloss: 0.534092
2024-04-12 00:24:34,845 P258112 INFO Save best model: monitor(max)=1.544981
2024-04-12 00:24:34,946 P258112 INFO ************ Epoch=3 end ************
2024-04-12 00:24:37,340 P258112 INFO Train loss: 0.934198
2024-04-12 00:24:37,340 P258112 INFO Evaluation @epoch 4 - batch 81: 
2024-04-12 00:24:43,356 P258112 INFO ===
2024-04-12 00:24:43,357 P258112 INFO [Metrics] AUC: 0.802011 - gAUC: 0.752287 - logloss: 0.529963
2024-04-12 00:24:43,358 P258112 INFO Save best model: monitor(max)=1.554298
2024-04-12 00:24:43,530 P258112 INFO ************ Epoch=4 end ************
2024-04-12 00:24:45,967 P258112 INFO Train loss: 0.926689
2024-04-12 00:24:45,968 P258112 INFO Evaluation @epoch 5 - batch 81: 
2024-04-12 00:24:52,695 P258112 INFO ===
2024-04-12 00:24:52,699 P258112 INFO [Metrics] AUC: 0.807882 - gAUC: 0.759806 - logloss: 0.522975
2024-04-12 00:24:52,699 P258112 INFO Save best model: monitor(max)=1.567688
2024-04-12 00:24:52,842 P258112 INFO ************ Epoch=5 end ************
2024-04-12 00:24:55,562 P258112 INFO Train loss: 0.920026
2024-04-12 00:24:55,562 P258112 INFO Evaluation @epoch 6 - batch 81: 
2024-04-12 00:25:02,005 P258112 INFO ===
2024-04-12 00:25:02,005 P258112 INFO [Metrics] AUC: 0.809137 - gAUC: 0.761899 - logloss: 0.523584
2024-04-12 00:25:02,006 P258112 INFO Save best model: monitor(max)=1.571035
2024-04-12 00:25:02,155 P258112 INFO ************ Epoch=6 end ************
2024-04-12 00:25:04,513 P258112 INFO Train loss: 0.916209
2024-04-12 00:25:04,513 P258112 INFO Evaluation @epoch 7 - batch 81: 
2024-04-12 00:25:11,723 P258112 INFO ===
2024-04-12 00:25:11,723 P258112 INFO [Metrics] AUC: 0.811289 - gAUC: 0.763813 - logloss: 0.523480
2024-04-12 00:25:11,723 P258112 INFO Save best model: monitor(max)=1.575102
2024-04-12 00:25:11,875 P258112 INFO ************ Epoch=7 end ************
2024-04-12 00:25:13,966 P258112 INFO Train loss: 0.912426
2024-04-12 00:25:13,966 P258112 INFO Evaluation @epoch 8 - batch 81: 
2024-04-12 00:25:20,949 P258112 INFO ===
2024-04-12 00:25:20,949 P258112 INFO [Metrics] AUC: 0.811696 - gAUC: 0.765952 - logloss: 0.520410
2024-04-12 00:25:20,949 P258112 INFO Save best model: monitor(max)=1.577649
2024-04-12 00:25:21,069 P258112 INFO ************ Epoch=8 end ************
2024-04-12 00:25:23,419 P258112 INFO Train loss: 0.907834
2024-04-12 00:25:23,419 P258112 INFO Evaluation @epoch 9 - batch 81: 
2024-04-12 00:25:30,162 P258112 INFO ===
2024-04-12 00:25:30,177 P258112 INFO [Metrics] AUC: 0.812857 - gAUC: 0.766654 - logloss: 0.518931
2024-04-12 00:25:30,177 P258112 INFO Save best model: monitor(max)=1.579511
2024-04-12 00:25:30,344 P258112 INFO ************ Epoch=9 end ************
2024-04-12 00:25:33,049 P258112 INFO Train loss: 0.906179
2024-04-12 00:25:33,049 P258112 INFO Evaluation @epoch 10 - batch 81: 
2024-04-12 00:25:39,693 P258112 INFO ===
2024-04-12 00:25:39,694 P258112 INFO [Metrics] AUC: 0.813724 - gAUC: 0.767899 - logloss: 0.517433
2024-04-12 00:25:39,694 P258112 INFO Save best model: monitor(max)=1.581623
2024-04-12 00:25:39,896 P258112 INFO ************ Epoch=10 end ************
2024-04-12 00:25:42,766 P258112 INFO Train loss: 0.904058
2024-04-12 00:25:42,767 P258112 INFO Evaluation @epoch 11 - batch 81: 
2024-04-12 00:25:47,942 P258112 INFO ===
2024-04-12 00:25:47,942 P258112 INFO [Metrics] AUC: 0.814077 - gAUC: 0.769851 - logloss: 0.517088
2024-04-12 00:25:47,942 P258112 INFO Save best model: monitor(max)=1.583928
2024-04-12 00:25:48,041 P258112 INFO ************ Epoch=11 end ************
2024-04-12 00:25:50,106 P258112 INFO Train loss: 0.903623
2024-04-12 00:25:50,107 P258112 INFO Evaluation @epoch 12 - batch 81: 
2024-04-12 00:25:56,305 P258112 INFO ===
2024-04-12 00:25:56,306 P258112 INFO [Metrics] AUC: 0.814109 - gAUC: 0.768471 - logloss: 0.516329
2024-04-12 00:25:56,306 P258112 INFO Monitor(max)=1.582580 STOP!
2024-04-12 00:25:56,306 P258112 INFO Reduce learning rate on plateau: 0.000100
2024-04-12 00:25:56,399 P258112 INFO ************ Epoch=12 end ************
2024-04-12 00:25:58,715 P258112 INFO Train loss: 0.837207
2024-04-12 00:25:58,715 P258112 INFO Evaluation @epoch 13 - batch 81: 
2024-04-12 00:26:05,940 P258112 INFO ===
2024-04-12 00:26:05,940 P258112 INFO [Metrics] AUC: 0.816477 - gAUC: 0.769618 - logloss: 0.516638
2024-04-12 00:26:05,940 P258112 INFO Save best model: monitor(max)=1.586095
2024-04-12 00:26:06,095 P258112 INFO ************ Epoch=13 end ************
2024-04-12 00:26:08,501 P258112 INFO Train loss: 0.816099
2024-04-12 00:26:08,502 P258112 INFO Evaluation @epoch 14 - batch 81: 
2024-04-12 00:26:15,200 P258112 INFO ===
2024-04-12 00:26:15,200 P258112 INFO [Metrics] AUC: 0.817266 - gAUC: 0.770837 - logloss: 0.518483
2024-04-12 00:26:15,201 P258112 INFO Save best model: monitor(max)=1.588103
2024-04-12 00:26:15,305 P258112 INFO ************ Epoch=14 end ************
2024-04-12 00:26:18,034 P258112 INFO Train loss: 0.803072
2024-04-12 00:26:18,034 P258112 INFO Evaluation @epoch 15 - batch 81: 
2024-04-12 00:26:24,660 P258112 INFO ===
2024-04-12 00:26:24,660 P258112 INFO [Metrics] AUC: 0.816641 - gAUC: 0.769599 - logloss: 0.520370
2024-04-12 00:26:24,661 P258112 INFO Monitor(max)=1.586240 STOP!
2024-04-12 00:26:24,661 P258112 INFO Reduce learning rate on plateau: 0.000010
2024-04-12 00:26:24,791 P258112 INFO ************ Epoch=15 end ************
2024-04-12 00:26:27,297 P258112 INFO Train loss: 0.785879
2024-04-12 00:26:27,298 P258112 INFO Evaluation @epoch 16 - batch 81: 
2024-04-12 00:26:34,020 P258112 INFO ===
2024-04-12 00:26:34,021 P258112 INFO [Metrics] AUC: 0.816587 - gAUC: 0.769547 - logloss: 0.520940
2024-04-12 00:26:34,021 P258112 INFO Monitor(max)=1.586133 STOP!
2024-04-12 00:26:34,021 P258112 INFO Reduce learning rate on plateau: 0.000001
2024-04-12 00:26:34,021 P258112 INFO ********* Epoch==16 early stop *********
2024-04-12 00:26:34,150 P258112 INFO Training finished.
2024-04-12 00:26:34,150 P258112 INFO Load best model: /mnt/public/lhh/code/model_zoo/TF4CTR/TF4CTR_torch/checkpoints/ML-1M_08e326cd/TF4CTRv2_ML-1M_071_273d227e.model
2024-04-12 00:26:34,158 P258112 INFO ****** Validation evaluation ******
2024-04-12 00:26:40,819 P258112 INFO ===
2024-04-12 00:26:40,819 P258112 INFO [Metrics] logloss: 0.518483 - AUC: 0.817266 - gAUC: 0.770837
2024-04-12 00:26:40,860 P258112 INFO ******** Test evaluation ********
2024-04-12 00:26:40,860 P258112 INFO Loading data...
2024-04-12 00:26:40,860 P258112 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/test.h5
2024-04-12 00:26:40,869 P258112 INFO Test samples: total/100021, blocks/1
2024-04-12 00:26:40,869 P258112 INFO Loading test data done.
2024-04-12 00:26:47,887 P258112 INFO ===
2024-04-12 00:26:47,887 P258112 INFO [Metrics] logloss: 0.519075 - AUC: 0.815866 - gAUC: 0.770513
