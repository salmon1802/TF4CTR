2024-04-11 20:45:39,014 P1945246 INFO Params: {
    "DFM": "VF",
    "SSM": "SER",
    "alpha": "0.25",
    "batch_norm": "True",
    "batch_size": "10000",
    "c": "0.9",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "ML-1M_08e326cd",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "easy_hidden_units": "[400]",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'int', 'name': 'group_id', 'preprocess': 'copy_from(UserID)', 'remap': False, 'type': 'meta'}, {'active': True, 'dtype': 'float', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID'], 'type': 'categorical'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gamma": "1",
    "gpu": "2",
    "group_id": "group_id",
    "hard_hidden_units": "[400, 400, 400]",
    "hidden_activations": "relu",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC', 'gAUC']",
    "min_categr_count": "2",
    "model": "TF4CTRv2",
    "model_id": "TF4CTRv2_ML-1M_012_8b19f368",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'gAUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_workers": "8",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2023",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/ML-1M/test.csv",
    "train_data": "../../../data/ML-1M/train.csv",
    "use_features": "None",
    "valid_data": "../../../data/ML-1M/valid.csv",
    "verbose": "1"
}
2024-04-11 20:45:39,016 P1945246 INFO Set up feature processor...
2024-04-11 20:45:39,016 P1945246 WARNING Skip rebuilding ../../../data/ML-1M_08e326cd/feature_map.json. Please delete it manually if rebuilding is required.
2024-04-11 20:45:39,016 P1945246 INFO Load feature_map from json: ../../../data/ML-1M_08e326cd/feature_map.json
2024-04-11 20:45:39,016 P1945246 INFO Set column index...
2024-04-11 20:45:39,016 P1945246 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3547, 'vocab_size': 3548}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22, 'vocab_size': 23}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6041, 'vocab_size': 6042}",
    "group_id": "{'type': 'meta'}"
}
2024-04-11 20:45:42,833 P1945246 INFO Total number of parameters: 605428.
2024-04-11 20:45:42,833 P1945246 INFO Loading data...
2024-04-11 20:45:42,834 P1945246 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/train.h5
2024-04-11 20:45:42,887 P1945246 INFO Train samples: total/800167, blocks/1
2024-04-11 20:45:42,888 P1945246 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/valid.h5
2024-04-11 20:45:42,893 P1945246 INFO Validation samples: total/100021, blocks/1
2024-04-11 20:45:42,894 P1945246 INFO Loading train and validation data done.
2024-04-11 20:45:42,894 P1945246 INFO Start training: 81 batches/epoch
2024-04-11 20:45:42,894 P1945246 INFO ************ Epoch=1 start ************
2024-04-11 20:45:45,919 P1945246 INFO Train loss: 1.069370
2024-04-11 20:45:45,919 P1945246 INFO Evaluation @epoch 1 - batch 81: 
2024-04-11 20:45:53,233 P1945246 INFO ===
2024-04-11 20:45:53,233 P1945246 INFO [Metrics] AUC: 0.784252 - gAUC: 0.726258 - logloss: 0.611060
2024-04-11 20:45:53,233 P1945246 INFO Save best model: monitor(max)=1.510511
2024-04-11 20:45:53,369 P1945246 INFO ************ Epoch=1 end ************
2024-04-11 20:45:56,357 P1945246 INFO Train loss: 1.005377
2024-04-11 20:45:56,358 P1945246 INFO Evaluation @epoch 2 - batch 81: 
2024-04-11 20:46:04,355 P1945246 INFO ===
2024-04-11 20:46:04,355 P1945246 INFO [Metrics] AUC: 0.796859 - gAUC: 0.745983 - logloss: 0.535975
2024-04-11 20:46:04,356 P1945246 INFO Save best model: monitor(max)=1.542843
2024-04-11 20:46:04,512 P1945246 INFO ************ Epoch=2 end ************
2024-04-11 20:46:07,310 P1945246 INFO Train loss: 0.987246
2024-04-11 20:46:07,310 P1945246 INFO Evaluation @epoch 3 - batch 81: 
2024-04-11 20:46:14,689 P1945246 INFO ===
2024-04-11 20:46:14,690 P1945246 INFO [Metrics] AUC: 0.802767 - gAUC: 0.755160 - logloss: 0.532209
2024-04-11 20:46:14,690 P1945246 INFO Save best model: monitor(max)=1.557927
2024-04-11 20:46:14,838 P1945246 INFO ************ Epoch=3 end ************
2024-04-11 20:46:17,879 P1945246 INFO Train loss: 0.976460
2024-04-11 20:46:17,880 P1945246 INFO Evaluation @epoch 4 - batch 81: 
2024-04-11 20:46:26,248 P1945246 INFO ===
2024-04-11 20:46:26,249 P1945246 INFO [Metrics] AUC: 0.808129 - gAUC: 0.760272 - logloss: 0.523138
2024-04-11 20:46:26,249 P1945246 INFO Save best model: monitor(max)=1.568401
2024-04-11 20:46:26,435 P1945246 INFO ************ Epoch=4 end ************
2024-04-11 20:46:29,457 P1945246 INFO Train loss: 0.971831
2024-04-11 20:46:29,458 P1945246 INFO Evaluation @epoch 5 - batch 81: 
2024-04-11 20:46:36,237 P1945246 INFO ===
2024-04-11 20:46:36,238 P1945246 INFO [Metrics] AUC: 0.808720 - gAUC: 0.760224 - logloss: 0.525117
2024-04-11 20:46:36,238 P1945246 INFO Save best model: monitor(max)=1.568944
2024-04-11 20:46:36,422 P1945246 INFO ************ Epoch=5 end ************
2024-04-11 20:46:39,345 P1945246 INFO Train loss: 0.966526
2024-04-11 20:46:39,345 P1945246 INFO Evaluation @epoch 6 - batch 81: 
2024-04-11 20:46:46,968 P1945246 INFO ===
2024-04-11 20:46:46,969 P1945246 INFO [Metrics] AUC: 0.810981 - gAUC: 0.763658 - logloss: 0.521262
2024-04-11 20:46:46,969 P1945246 INFO Save best model: monitor(max)=1.574639
2024-04-11 20:46:47,117 P1945246 INFO ************ Epoch=6 end ************
2024-04-11 20:46:49,795 P1945246 INFO Train loss: 0.963326
2024-04-11 20:46:49,796 P1945246 INFO Evaluation @epoch 7 - batch 81: 
2024-04-11 20:46:57,379 P1945246 INFO ===
2024-04-11 20:46:57,379 P1945246 INFO [Metrics] AUC: 0.810812 - gAUC: 0.763928 - logloss: 0.524690
2024-04-11 20:46:57,379 P1945246 INFO Save best model: monitor(max)=1.574740
2024-04-11 20:46:57,520 P1945246 INFO ************ Epoch=7 end ************
2024-04-11 20:47:00,400 P1945246 INFO Train loss: 0.960876
2024-04-11 20:47:00,400 P1945246 INFO Evaluation @epoch 8 - batch 81: 
2024-04-11 20:47:07,748 P1945246 INFO ===
2024-04-11 20:47:07,748 P1945246 INFO [Metrics] AUC: 0.810924 - gAUC: 0.763824 - logloss: 0.521612
2024-04-11 20:47:07,749 P1945246 INFO Save best model: monitor(max)=1.574748
2024-04-11 20:47:07,882 P1945246 INFO ************ Epoch=8 end ************
2024-04-11 20:47:10,493 P1945246 INFO Train loss: 0.959143
2024-04-11 20:47:10,493 P1945246 INFO Evaluation @epoch 9 - batch 81: 
2024-04-11 20:47:18,189 P1945246 INFO ===
2024-04-11 20:47:18,189 P1945246 INFO [Metrics] AUC: 0.812166 - gAUC: 0.765334 - logloss: 0.519944
2024-04-11 20:47:18,189 P1945246 INFO Save best model: monitor(max)=1.577500
2024-04-11 20:47:18,361 P1945246 INFO ************ Epoch=9 end ************
2024-04-11 20:47:20,822 P1945246 INFO Train loss: 0.959394
2024-04-11 20:47:20,822 P1945246 INFO Evaluation @epoch 10 - batch 81: 
2024-04-11 20:47:28,827 P1945246 INFO ===
2024-04-11 20:47:28,828 P1945246 INFO [Metrics] AUC: 0.812871 - gAUC: 0.765392 - logloss: 0.519135
2024-04-11 20:47:28,828 P1945246 INFO Save best model: monitor(max)=1.578263
2024-04-11 20:47:28,957 P1945246 INFO ************ Epoch=10 end ************
2024-04-11 20:47:31,359 P1945246 INFO Train loss: 0.958969
2024-04-11 20:47:31,359 P1945246 INFO Evaluation @epoch 11 - batch 81: 
2024-04-11 20:47:38,676 P1945246 INFO ===
2024-04-11 20:47:38,676 P1945246 INFO [Metrics] AUC: 0.812841 - gAUC: 0.766762 - logloss: 0.522082
2024-04-11 20:47:38,676 P1945246 INFO Save best model: monitor(max)=1.579604
2024-04-11 20:47:38,796 P1945246 INFO ************ Epoch=11 end ************
2024-04-11 20:47:41,511 P1945246 INFO Train loss: 0.957081
2024-04-11 20:47:41,512 P1945246 INFO Evaluation @epoch 12 - batch 81: 
2024-04-11 20:47:49,349 P1945246 INFO ===
2024-04-11 20:47:49,349 P1945246 INFO [Metrics] AUC: 0.813799 - gAUC: 0.768203 - logloss: 0.519083
2024-04-11 20:47:49,349 P1945246 INFO Save best model: monitor(max)=1.582002
2024-04-11 20:47:49,492 P1945246 INFO ************ Epoch=12 end ************
2024-04-11 20:47:51,923 P1945246 INFO Train loss: 0.956517
2024-04-11 20:47:51,923 P1945246 INFO Evaluation @epoch 13 - batch 81: 
2024-04-11 20:47:59,118 P1945246 INFO ===
2024-04-11 20:47:59,118 P1945246 INFO [Metrics] AUC: 0.813098 - gAUC: 0.767015 - logloss: 0.520180
2024-04-11 20:47:59,119 P1945246 INFO Monitor(max)=1.580113 STOP!
2024-04-11 20:47:59,119 P1945246 INFO Reduce learning rate on plateau: 0.000100
2024-04-11 20:47:59,252 P1945246 INFO ************ Epoch=13 end ************
2024-04-11 20:48:01,813 P1945246 INFO Train loss: 0.901576
2024-04-11 20:48:01,814 P1945246 INFO Evaluation @epoch 14 - batch 81: 
2024-04-11 20:48:09,242 P1945246 INFO ===
2024-04-11 20:48:09,243 P1945246 INFO [Metrics] AUC: 0.815454 - gAUC: 0.768577 - logloss: 0.518355
2024-04-11 20:48:09,243 P1945246 INFO Save best model: monitor(max)=1.584032
2024-04-11 20:48:09,376 P1945246 INFO ************ Epoch=14 end ************
2024-04-11 20:48:12,075 P1945246 INFO Train loss: 0.881924
2024-04-11 20:48:12,075 P1945246 INFO Evaluation @epoch 15 - batch 81: 
2024-04-11 20:48:19,884 P1945246 INFO ===
2024-04-11 20:48:19,884 P1945246 INFO [Metrics] AUC: 0.816087 - gAUC: 0.768674 - logloss: 0.518597
2024-04-11 20:48:19,885 P1945246 INFO Save best model: monitor(max)=1.584761
2024-04-11 20:48:20,054 P1945246 INFO ************ Epoch=15 end ************
2024-04-11 20:48:22,997 P1945246 INFO Train loss: 0.869937
2024-04-11 20:48:22,997 P1945246 INFO Evaluation @epoch 16 - batch 81: 
2024-04-11 20:48:29,740 P1945246 INFO ===
2024-04-11 20:48:29,740 P1945246 INFO [Metrics] AUC: 0.816102 - gAUC: 0.768561 - logloss: 0.519911
2024-04-11 20:48:29,740 P1945246 INFO Monitor(max)=1.584663 STOP!
2024-04-11 20:48:29,741 P1945246 INFO Reduce learning rate on plateau: 0.000010
2024-04-11 20:48:29,873 P1945246 INFO ************ Epoch=16 end ************
2024-04-11 20:48:32,686 P1945246 INFO Train loss: 0.850820
2024-04-11 20:48:32,687 P1945246 INFO Evaluation @epoch 17 - batch 81: 
2024-04-11 20:48:39,942 P1945246 INFO ===
2024-04-11 20:48:39,942 P1945246 INFO [Metrics] AUC: 0.816440 - gAUC: 0.769224 - logloss: 0.519718
2024-04-11 20:48:39,943 P1945246 INFO Save best model: monitor(max)=1.585664
2024-04-11 20:48:40,101 P1945246 INFO ************ Epoch=17 end ************
2024-04-11 20:48:42,997 P1945246 INFO Train loss: 0.849278
2024-04-11 20:48:42,997 P1945246 INFO Evaluation @epoch 18 - batch 81: 
2024-04-11 20:48:50,560 P1945246 INFO ===
2024-04-11 20:48:50,561 P1945246 INFO [Metrics] AUC: 0.816385 - gAUC: 0.769142 - logloss: 0.519888
2024-04-11 20:48:50,561 P1945246 INFO Monitor(max)=1.585527 STOP!
2024-04-11 20:48:50,561 P1945246 INFO Reduce learning rate on plateau: 0.000001
2024-04-11 20:48:50,693 P1945246 INFO ************ Epoch=18 end ************
2024-04-11 20:48:53,472 P1945246 INFO Train loss: 0.846992
2024-04-11 20:48:53,473 P1945246 INFO Evaluation @epoch 19 - batch 81: 
2024-04-11 20:49:00,601 P1945246 INFO ===
2024-04-11 20:49:00,601 P1945246 INFO [Metrics] AUC: 0.816471 - gAUC: 0.769464 - logloss: 0.520044
2024-04-11 20:49:00,602 P1945246 INFO Save best model: monitor(max)=1.585935
2024-04-11 20:49:00,735 P1945246 INFO ************ Epoch=19 end ************
2024-04-11 20:49:03,277 P1945246 INFO Train loss: 0.847580
2024-04-11 20:49:03,277 P1945246 INFO Evaluation @epoch 20 - batch 81: 
2024-04-11 20:49:10,676 P1945246 INFO ===
2024-04-11 20:49:10,676 P1945246 INFO [Metrics] AUC: 0.816585 - gAUC: 0.769499 - logloss: 0.520042
2024-04-11 20:49:10,676 P1945246 INFO Save best model: monitor(max)=1.586083
2024-04-11 20:49:10,817 P1945246 INFO ************ Epoch=20 end ************
2024-04-11 20:49:13,623 P1945246 INFO Train loss: 0.847429
2024-04-11 20:49:13,624 P1945246 INFO Evaluation @epoch 21 - batch 81: 
2024-04-11 20:49:21,257 P1945246 INFO ===
2024-04-11 20:49:21,258 P1945246 INFO [Metrics] AUC: 0.816201 - gAUC: 0.768865 - logloss: 0.520142
2024-04-11 20:49:21,258 P1945246 INFO Monitor(max)=1.585066 STOP!
2024-04-11 20:49:21,258 P1945246 INFO Reduce learning rate on plateau: 0.000001
2024-04-11 20:49:21,390 P1945246 INFO ************ Epoch=21 end ************
2024-04-11 20:49:23,900 P1945246 INFO Train loss: 0.846735
2024-04-11 20:49:23,900 P1945246 INFO Evaluation @epoch 22 - batch 81: 
2024-04-11 20:49:31,251 P1945246 INFO ===
2024-04-11 20:49:31,251 P1945246 INFO [Metrics] AUC: 0.816361 - gAUC: 0.769232 - logloss: 0.520411
2024-04-11 20:49:31,251 P1945246 INFO Monitor(max)=1.585593 STOP!
2024-04-11 20:49:31,251 P1945246 INFO Reduce learning rate on plateau: 0.000001
2024-04-11 20:49:31,251 P1945246 INFO ********* Epoch==22 early stop *********
2024-04-11 20:49:31,386 P1945246 INFO Training finished.
2024-04-11 20:49:31,386 P1945246 INFO Load best model: /mnt/public/lhh/code/model_zoo/TF4CTR/TF4CTR_torch/checkpoints/ML-1M_08e326cd/TF4CTRv2_ML-1M_012_8b19f368.model
2024-04-11 20:49:31,391 P1945246 INFO ****** Validation evaluation ******
2024-04-11 20:49:38,899 P1945246 INFO ===
2024-04-11 20:49:38,899 P1945246 INFO [Metrics] logloss: 0.520298 - AUC: 0.816469 - gAUC: 0.768971
2024-04-11 20:49:38,939 P1945246 INFO ******** Test evaluation ********
2024-04-11 20:49:38,940 P1945246 INFO Loading data...
2024-04-11 20:49:38,940 P1945246 INFO Loading data from h5: ../../../data/ML-1M_08e326cd/test.h5
2024-04-11 20:49:38,949 P1945246 INFO Test samples: total/100021, blocks/1
2024-04-11 20:49:38,949 P1945246 INFO Loading test data done.
2024-04-11 20:49:46,318 P1945246 INFO ===
2024-04-11 20:49:46,318 P1945246 INFO [Metrics] logloss: 0.519625 - AUC: 0.815743 - gAUC: 0.770139
